<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>JS Fuck</title>
        <link rel="stylesheet" href="./spinner.css" />
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- There is a jsfuck cdn but i used this one instead, fix nest time -->
        <script
            defer
            src="https://jsfuck.com/jsfuck.js"
            onload="document.body.setAttribute('script-loadded','')"
        ></script>
        <script
            src="https://code.jquery.com/jquery-3.7.0.slim.min.js"
            integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE="
            crossorigin="anonymous"
        ></script>
        <style>
            body[script-loadded] .lds-roller {
                opacity: 0;
            }
            body[script-loadded] main {
                opacity: 1;
            }
        </style>
    </head>
    <body class="bg-indigo-950 text-white flex items-center justify-center w-screen h-screen m-0">
        <div class="lds-roller absolute transition delay-200">
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
            <div class="after:bg-indigo-200"></div>
        </div>
        <main class="opacity-0 transition delay-700 z-10">
            <div id="in" contenteditable="true" class="outline-0 p-4">alert(1)</div>
            <script>
                $('#in').on('keyup', function (e) {
                    updateOutput($('#in').text())
                })
                function updateOutput(text) {
                    const outEl = $('#out')
                    outEl.replaceWith(
                        $(document.createElement('script'))
                            .attr({ id: 'out', class: outEl.attr('class') })
                            .html(runAndEncode(text))
                    )
                }
                // https://github.com/aemkei/jsfuck#basics
                function runAndEncode(text) {
                    return `[][${JSFuck.encode('filter')}][${JSFuck.encode('constructor')}](${JSFuck.encode(text)})()`
                }
            </script>
            <script id="out" class="block"></script>
        </main>
    </body>
</html>
